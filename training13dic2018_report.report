Initializing image normalization.
|======================================================================================================================|
|  Epoch  |  Iteration  |  Time Elapsed  |  Mini-batch  |  Validation  |  Mini-batch  |  Validation  |  Base Learning  |
|         |             |   (hh:mm:ss)   |   Accuracy   |   Accuracy   |     Loss     |     Loss     |      Rate       |
|======================================================================================================================|
|       1 |           1 |       00:02:18 |       40.00% |       27.80% |       1.1249 |       1.2500 |          0.0003 |
|       1 |           3 |       00:04:40 |       10.00% |       35.49% |       1.4571 |       1.1252 |          0.0003 |
|       1 |           6 |       00:07:10 |       40.00% |       35.75% |       1.1031 |       1.1656 |          0.0003 |
|       1 |           9 |       00:09:40 |       50.00% |       33.52% |       0.9063 |       1.2337 |          0.0003 |
|       1 |          12 |       00:12:01 |       20.00% |       51.54% |       1.1440 |       0.9789 |          0.0003 |
|       1 |          15 |       00:14:35 |       60.00% |       50.94% |       1.2894 |       1.0883 |          0.0003 |
|       1 |          18 |       00:17:16 |       60.00% |       58.03% |       1.3094 |       0.9545 |          0.0003 |
|       1 |          21 |       00:20:01 |       70.00% |       42.99% |       0.8247 |       1.2615 |          0.0003 |
|       1 |          24 |       00:22:48 |       50.00% |       56.76% |       1.0366 |       0.9020 |          0.0003 |
|       1 |          27 |       00:25:50 |       40.00% |       60.25% |       1.0633 |       0.8307 |          0.0003 |
|       1 |          30 |       00:28:36 |       30.00% |       59.70% |       1.2213 |       0.9168 |          0.0003 |
|       1 |          33 |       00:31:12 |       40.00% |       60.66% |       1.3887 |       0.8627 |          0.0003 |
|       1 |          36 |       00:33:45 |       50.00% |       52.56% |       1.5646 |       1.2256 |          0.0003 |
|       1 |          39 |       00:36:38 |       20.00% |       54.84% |       1.6840 |       0.9362 |          0.0003 |
|       1 |          42 |       00:39:21 |       40.00% |       59.85% |       1.4733 |       0.8749 |          0.0003 |
|       1 |          45 |       00:42:06 |       20.00% |       56.81% |       1.1463 |       0.8184 |          0.0003 |
|       1 |          48 |       00:44:45 |       60.00% |       53.87% |       0.9019 |       0.8753 |          0.0003 |
|       1 |          50 |       00:44:49 |       30.00% |              |       1.2038 |              |          0.0003 |
|       1 |          51 |       00:47:35 |       60.00% |       54.53% |       1.1961 |       0.8717 |          0.0003 |
|       1 |          54 |       00:50:22 |       80.00% |       45.87% |       0.5799 |       0.9853 |          0.0003 |
|       1 |          57 |       00:53:47 |       20.00% |       44.41% |       1.5645 |       1.0518 |          0.0003 |
|       1 |          60 |       00:56:35 |       60.00% |       47.54% |       0.8951 |       0.9976 |          0.0003 |
|       1 |          63 |       00:59:43 |       30.00% |       51.24% |       1.2556 |       0.9834 |          0.0003 |
|       1 |          66 |       01:02:21 |       30.00% |       53.67% |       1.2641 |       0.8800 |          0.0003 |
|       1 |          69 |       01:05:11 |       60.00% |       56.66% |       0.7695 |       0.9055 |          0.0003 |
|       1 |          72 |       01:07:52 |       40.00% |       55.09% |       1.4208 |       0.9985 |          0.0003 |
|       1 |          75 |       01:10:57 |       40.00% |       48.00% |       0.9159 |       0.9700 |          0.0003 |
|       1 |          78 |       01:13:43 |       50.00% |       51.65% |       1.1100 |       0.9604 |          0.0003 |
|       1 |          81 |       01:16:32 |       50.00% |       56.56% |       1.0139 |       0.8550 |          0.0003 |
|       1 |          84 |       01:19:16 |       30.00% |       57.22% |       1.5377 |       0.8288 |          0.0003 |
|       1 |          87 |       01:21:52 |       60.00% |       60.05% |       0.7388 |       0.8395 |          0.0003 |
|       1 |          90 |       01:24:59 |       60.00% |       58.33% |       1.0749 |       0.8731 |          0.0003 |
|       1 |          93 |       01:27:38 |       80.00% |       61.16% |       0.4926 |       0.8280 |          0.0003 |
|       1 |          96 |       01:30:37 |       70.00% |       61.62% |       0.7566 |       0.8158 |          0.0003 |
|       1 |          99 |       01:33:46 |       60.00% |       60.76% |       1.0226 |       0.8307 |          0.0003 |
|       1 |         100 |       01:33:48 |       50.00% |              |       0.9819 |              |          0.0003 |
|       1 |         102 |       01:36:41 |       50.00% |       59.75% |       0.9424 |       0.8520 |          0.0003 |
|       1 |         105 |       01:39:39 |       40.00% |       57.82% |       0.8508 |       0.8452 |          0.0003 |
|       1 |         108 |       01:42:24 |       60.00% |       55.14% |       0.8329 |       0.8842 |          0.0003 |
|       1 |         111 |       01:45:14 |       40.00% |       54.13% |       0.9393 |       0.9218 |          0.0003 |
|       1 |         114 |       01:48:10 |       40.00% |       51.09% |       1.0217 |       0.9280 |          0.0003 |
|       1 |         117 |       01:51:05 |       50.00% |       55.90% |       0.8901 |       0.8851 |          0.0003 |
|       1 |         120 |       01:53:57 |       50.00% |       56.20% |       0.8787 |       0.8744 |          0.0003 |
|       1 |         123 |       01:56:51 |       80.00% |       54.78% |       0.7031 |       0.8919 |          0.0003 |
|       1 |         126 |       01:59:54 |       20.00% |       53.27% |       1.4048 |       0.9106 |          0.0003 |
|       1 |         129 |       02:03:03 |       60.00% |       54.38% |       0.9006 |       0.9123 |          0.0003 |
|       1 |         132 |       02:05:57 |       50.00% |       55.09% |       0.9666 |       0.9247 |          0.0003 |
|       1 |         135 |       02:08:48 |       40.00% |       55.14% |       1.0224 |       0.8793 |          0.0003 |
|       1 |         138 |       02:12:01 |       50.00% |       57.77% |       0.8846 |       0.8479 |          0.0003 |
|       1 |         141 |       02:14:51 |       80.00% |       58.89% |       0.7203 |       0.8843 |          0.0003 |
|       1 |         144 |       02:18:03 |       30.00% |       59.65% |       1.5361 |       0.9341 |          0.0003 |
|       1 |         147 |       02:21:18 |       60.00% |       58.99% |       1.0201 |       0.9347 |          0.0003 |
|       1 |         150 |       02:24:17 |       50.00% |       51.75% |       1.0831 |       0.9514 |          0.0003 |
|       1 |         153 |       02:27:37 |       40.00% |       46.18% |       1.0461 |       0.9679 |          0.0003 |
|       1 |         156 |       02:30:41 |       50.00% |       48.15% |       0.8717 |       0.9506 |          0.0003 |
|       1 |         159 |       02:33:33 |       50.00% |       51.49% |       1.0570 |       0.9225 |          0.0003 |
|       1 |         162 |       02:36:27 |       60.00% |       53.27% |       0.8269 |       0.9019 |          0.0003 |
|       1 |         165 |       02:39:30 |       20.00% |       54.84% |       1.1112 |       0.8864 |          0.0003 |
|       1 |         168 |       02:42:18 |       50.00% |       54.08% |       0.9928 |       0.8872 |          0.0003 |
|       1 |         171 |       02:45:16 |       50.00% |       53.82% |       0.9391 |       0.9017 |          0.0003 |
|       1 |         174 |       02:48:05 |       70.00% |       54.28% |       0.8669 |       0.9124 |          0.0003 |
|       1 |         177 |       02:50:49 |       50.00% |       54.48% |       0.7921 |       0.8924 |          0.0003 |
|       1 |         180 |       02:53:59 |       70.00% |       55.19% |       0.6482 |       0.8792 |          0.0003 |
|       1 |         183 |       02:56:36 |       60.00% |       56.15% |       0.8537 |       0.8668 |          0.0003 |
|       1 |         186 |       02:59:30 |       50.00% |       56.20% |       0.8709 |       0.8598 |          0.0003 |
|       1 |         189 |       03:02:35 |       30.00% |       56.61% |       1.2800 |       0.8539 |          0.0003 |
|       1 |         192 |       03:05:35 |       80.00% |       57.27% |       0.8552 |       0.8547 |          0.0003 |
|       1 |         195 |       03:09:00 |       40.00% |       57.32% |       1.0440 |       0.8467 |          0.0003 |
|       1 |         198 |       03:13:06 |       90.00% |       56.35% |       0.6932 |       0.8395 |          0.0003 |
|       1 |         200 |       03:13:11 |       30.00% |              |       1.0894 |              |          0.0003 |
|       1 |         201 |       03:16:02 |       50.00% |       56.71% |       1.0697 |       0.8389 |          0.0003 |
|       1 |         204 |       03:18:52 |       40.00% |       55.59% |       0.8903 |       0.8400 |          0.0003 |
|       1 |         207 |       03:21:57 |       60.00% |       55.54% |       0.7731 |       0.8459 |          0.0003 |
|       1 |         210 |       03:24:41 |       70.00% |       55.44% |       0.8738 |       0.8536 |          0.0003 |
|       1 |         213 |       03:27:37 |       60.00% |       55.85% |       0.8925 |       0.8656 |          0.0003 |
|       1 |         216 |       03:30:42 |       60.00% |       54.03% |       0.7538 |       0.8823 |          0.0003 |
|       1 |         219 |       03:33:52 |       80.00% |       52.15% |       0.6752 |       0.8999 |          0.0003 |
|       1 |         222 |       03:36:45 |       60.00% |       51.95% |       0.8842 |       0.9036 |          0.0003 |
|       1 |         225 |       03:40:05 |       60.00% |       52.05% |       0.6129 |       0.9062 |          0.0003 |
|       1 |         228 |       03:43:05 |       50.00% |       51.04% |       0.9548 |       0.8898 |          0.0003 |
|       1 |         231 |       03:46:18 |       50.00% |       52.71% |       0.8444 |       0.8569 |          0.0003 |
|       1 |         234 |       03:49:44 |       40.00% |       54.63% |       0.9853 |       0.8353 |          0.0003 |
|       1 |         237 |       03:52:35 |       60.00% |       56.76% |       0.7946 |       0.8307 |          0.0003 |
|       1 |         240 |       03:55:35 |       50.00% |       57.06% |       0.8427 |       0.8265 |          0.0003 |
|       1 |         243 |       03:58:32 |       50.00% |       56.91% |       0.8874 |       0.8375 |          0.0003 |
|       1 |         246 |       04:01:39 |       50.00% |       54.89% |       0.9231 |       0.8663 |          0.0003 |
|       1 |         249 |       04:04:56 |       60.00% |       54.63% |       1.0716 |       0.8647 |          0.0003 |
|       1 |         250 |       04:04:59 |       60.00% |              |       0.8138 |              |          0.0003 |
|       1 |         252 |       04:08:03 |       80.00% |       55.95% |       0.7201 |       0.8277 |          0.0003 |
|       1 |         255 |       04:11:00 |       50.00% |       55.80% |       1.0801 |       0.8438 |          0.0003 |
|       1 |         258 |       04:13:59 |       70.00% |       53.92% |       0.7071 |       0.8560 |          0.0003 |
|       1 |         261 |       04:16:47 |       30.00% |       53.57% |       1.1758 |       0.8559 |          0.0003 |
|       1 |         264 |       04:19:39 |       30.00% |       54.53% |       0.8908 |       0.8608 |          0.0003 |
|       1 |         267 |       04:22:41 |       80.00% |       55.59% |       0.7154 |       0.8568 |          0.0003 |
|       1 |         270 |       04:25:49 |       50.00% |       55.70% |       0.7001 |       0.8508 |          0.0003 |
|       1 |         273 |       04:28:35 |       40.00% |       55.65% |       1.0331 |       0.8418 |          0.0003 |
|       1 |         276 |       04:31:46 |       60.00% |       57.92% |       0.8414 |       0.8207 |          0.0003 |
|       1 |         279 |       04:34:46 |       40.00% |       58.78% |       1.0016 |       0.8131 |          0.0003 |
|       1 |         282 |       04:37:37 |       50.00% |       59.34% |       0.7843 |       0.8296 |          0.0003 |
|       1 |         285 |       04:40:23 |       60.00% |       59.19% |       1.0163 |       0.8473 |          0.0003 |
|       1 |         288 |       04:43:21 |       40.00% |       57.42% |       0.9594 |       0.8591 |          0.0003 |
|       1 |         291 |       04:46:07 |       90.00% |       55.95% |       0.5541 |       0.8745 |          0.0003 |
|       1 |         294 |       04:48:55 |       50.00% |       53.72% |       0.6931 |       0.8801 |          0.0003 |
|       1 |         297 |       04:51:55 |       80.00% |       54.58% |       0.8155 |       0.8682 |          0.0003 |
|       1 |         300 |       04:54:48 |       70.00% |       56.46% |       0.7897 |       0.8487 |          0.0003 |
|       1 |         303 |       04:58:02 |       50.00% |       56.25% |       1.0039 |       0.8482 |          0.0003 |
|       1 |         306 |       05:00:49 |       50.00% |       56.41% |       1.0373 |       0.8484 |          0.0003 |
|       1 |         309 |       05:03:47 |       70.00% |       57.32% |       0.8485 |       0.8347 |          0.0003 |
|       1 |         312 |       05:06:38 |       70.00% |       57.32% |       0.6774 |       0.8288 |          0.0003 |
|       1 |         315 |       05:09:53 |       40.00% |       57.16% |       1.1809 |       0.8258 |          0.0003 |
|       1 |         318 |       05:13:10 |       60.00% |       57.32% |       1.0864 |       0.8336 |          0.0003 |
|       1 |         321 |       05:16:43 |       50.00% |       58.28% |       0.8916 |       0.8319 |          0.0003 |
|       1 |         324 |       05:19:23 |       50.00% |       58.78% |       1.1112 |       0.8354 |          0.0003 |
|       1 |         327 |       05:22:40 |       40.00% |       58.08% |       0.9091 |       0.8388 |          0.0003 |
|       1 |         330 |       05:25:51 |       30.00% |       58.03% |       1.1615 |       0.8480 |          0.0003 |
|       1 |         333 |       05:29:08 |       30.00% |       56.66% |       1.2902 |       0.8612 |          0.0003 |
|       1 |         336 |       05:32:16 |       70.00% |       55.14% |       0.9681 |       0.8729 |          0.0003 |
|       1 |         339 |       05:35:10 |       70.00% |       55.34% |       0.9236 |       0.8566 |          0.0003 |
|       1 |         342 |       05:38:21 |       60.00% |       56.96% |       0.8719 |       0.8429 |          0.0003 |
|       1 |         345 |       05:41:43 |       50.00% |       56.96% |       1.0639 |       0.8309 |          0.0003 |
|       1 |         348 |       05:45:06 |       60.00% |       57.22% |       0.9571 |       0.8238 |          0.0003 |
|       1 |         350 |       05:45:10 |       60.00% |              |       0.9151 |              |          0.0003 |
|       1 |         351 |       05:48:08 |       70.00% |       57.01% |       0.8079 |       0.8294 |          0.0003 |
|       1 |         354 |       05:51:05 |       40.00% |       58.33% |       1.0722 |       0.8339 |          0.0003 |
|       1 |         357 |       05:54:15 |       50.00% |       59.24% |       0.8769 |       0.8377 |          0.0003 |
|       1 |         360 |       05:57:15 |       70.00% |       59.34% |       0.7806 |       0.8374 |          0.0003 |
|       1 |         363 |       06:00:20 |       80.00% |       56.76% |       0.7257 |       0.8685 |          0.0003 |
|       1 |         366 |       06:03:36 |       50.00% |       55.95% |       0.9549 |       0.8698 |          0.0003 |
|       1 |         369 |       06:06:47 |       60.00% |       58.63% |       0.8846 |       0.8412 |          0.0003 |
|       1 |         372 |       06:09:40 |       70.00% |       59.49% |       0.6680 |       0.8148 |          0.0003 |
|       1 |         375 |       06:12:36 |       40.00% |       59.14% |       0.8966 |       0.8029 |          0.0003 |
|       1 |         378 |       06:15:34 |       50.00% |       58.78% |       0.8531 |       0.8014 |          0.0003 |
|       1 |         381 |       06:18:57 |       60.00% |       60.25% |       0.8555 |       0.8020 |          0.0003 |
|       1 |         384 |       06:22:08 |       80.00% |       60.51% |       0.7243 |       0.7997 |          0.0003 |
|       1 |         387 |       06:25:09 |       50.00% |       59.65% |       0.8638 |       0.8206 |          0.0003 |
|       1 |         390 |       06:28:27 |       60.00% |       57.42% |       0.9515 |       0.8419 |          0.0003 |
|       1 |         393 |       06:31:26 |       50.00% |       57.52% |       0.8071 |       0.8351 |          0.0003 |
|       1 |         396 |       06:34:16 |       50.00% |       58.58% |       0.8885 |       0.8164 |          0.0003 |
|       1 |         399 |       06:37:26 |       50.00% |       58.13% |       1.0120 |       0.8189 |          0.0003 |
|       1 |         400 |       06:37:28 |       50.00% |              |       0.9890 |              |          0.0003 |
|       1 |         402 |       06:40:31 |       60.00% |       56.15% |       0.8028 |       0.8373 |          0.0003 |
|       1 |         405 |       06:43:30 |       50.00% |       55.04% |       0.9432 |       0.8524 |          0.0003 |
|       1 |         408 |       06:46:45 |       60.00% |       54.84% |       0.8965 |       0.8541 |          0.0003 |
|       1 |         411 |       06:49:51 |       50.00% |       56.91% |       0.8303 |       0.8370 |          0.0003 |
|       1 |         414 |       06:53:25 |       70.00% |       57.97% |       0.7551 |       0.8270 |          0.0003 |
|       1 |         417 |       06:56:39 |       70.00% |       59.29% |       0.7231 |       0.8184 |          0.0003 |
|       1 |         420 |       06:59:51 |       70.00% |       60.30% |       0.6744 |       0.8200 |          0.0003 |
|       1 |         423 |       07:02:37 |       30.00% |       60.15% |       0.9888 |       0.8250 |          0.0003 |
|       1 |         426 |       07:05:24 |       70.00% |       59.39% |       0.5823 |       0.8288 |          0.0003 |
|       1 |         429 |       07:08:28 |       70.00% |       57.82% |       0.6658 |       0.8367 |          0.0003 |
|       1 |         432 |       07:11:54 |       60.00% |       56.86% |       0.9062 |       0.8487 |          0.0003 |
|       1 |         435 |       07:15:10 |       80.00% |       55.75% |       0.6458 |       0.8521 |          0.0003 |
|       1 |         438 |       07:18:36 |       40.00% |       55.49% |       0.9470 |       0.8571 |          0.0003 |
|======================================================================================================================|

accuracy =

    0.5549

Error using  ==  (line 25)
Invalid types for comparison.

Error in confusion (line 45)
if ~all((targets==0) | (targets==1) | isnan(targets))

Error in training_with_transfer (line 99)
[c1,cm1,ind1,per1] = confusion(YPred,imdsValidation.Labels);
 
>> idx = randperm(numel(imdsValidation.Files),4);
figure
for i = 1:4
    subplot(2,2,i)
    I = readimage(imdsValidation,idx(i));
    imshow(I)
    label = YPred(idx(i));
    title(string(label) + ", " + num2str(100*max(probs(idx(i),:)),3) + "%");
end

save('model', 'net');
>> 
